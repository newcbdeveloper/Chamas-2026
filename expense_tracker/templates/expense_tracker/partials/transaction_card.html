{% load expense_filters %}

<div class="transaction-item {% if transaction.type == 'income' %}income{% else %}expense{% endif %}">
    <div class="transaction-icon">
    {% if transaction.category and transaction.category.icon %}
        <i class="{{ transaction.category.icon }}"></i>
    {% else %}
        <i class="fas fa-tag"></i>
    {% endif %}
    </div>
    
    <div class="transaction-details">
        <h6 class="transaction-category">
            {{ transaction.category.name|default:"Uncategorized" }}
        </h6>
        {% if transaction.description %}
            <p class="transaction-description">{{ transaction.description }}</p>
        {% endif %}
        <small class="transaction-time">
            <i class="fas fa-clock me-1"></i>{{ transaction.created_at|time:"g:i A" }}
        </small>
    </div>
    
    <div class="transaction-amount">
        {% if transaction.type == 'income' %}
            <span class="text-success">+ {{ transaction.amount|currency }}</span>
        {% else %}
            <span class="text-danger">- {{ transaction.amount|currency }}</span>
        {% endif %}
    </div>
    
    <div class="transaction-actions">
        <a href="{% url 'expense_tracker:transaction_edit' transaction.pk %}" class="btn btn-sm btn-outline-primary" title="Edit">
            <i class="fas fa-edit"></i>
        </a>
        <button type="button" 
                class="btn btn-sm btn-outline-danger delete-transaction" 
                data-bs-toggle="modal"
                data-bs-target="#deleteModal{{ transaction.pk }}"
                title="Delete">
            <i class="fas fa-trash"></i>
        </button>
    </div>
</div>

<!-- Delete Confirmation Modal (unchanged) -->
<div class="modal fade" id="deleteModal{{ transaction.pk }}" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete this transaction?</p>
                <div class="alert alert-warning">
                    <strong>{{ transaction.category.name|default:"Uncategorized" }}</strong><br>
                    Amount: {{ transaction.amount|currency }}<br>
                    Date: {{ transaction.date }}
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <form method="post" action="{% url 'expense_tracker:transaction_delete' transaction.pk %}" style="display: inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
            </div>
        </div>
    </div>
</div>